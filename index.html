<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Peikai Guo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Magento, ASP.NET MVC">
<meta property="og:type" content="website">
<meta property="og:title" content="Peikai Guo">
<meta property="og:url" content="http://dujushi.github.io/index.html">
<meta property="og:site_name" content="Peikai Guo">
<meta property="og:description" content="Magento, ASP.NET MVC">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Peikai Guo">
<meta name="twitter:description" content="Magento, ASP.NET MVC">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="/webfonts/ptserif/main.css" rel='stylesheet' type='text/css'>
  <link href="/webfonts/source-code-pro/main.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-68591531-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


</head>

<body>
  <div id="container">
    <header id="header">
  <div id="header-outer" class="outer">
    <div id="header-inner" class="inner">
      <a id="main-nav-toggle" class="nav-icon" href="javascript:;"></a>
      <a id="logo" class="logo logo-text" href="/">Peikai</a>
      <nav id="main-nav">
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/categories">Categories</a>
        
          <a class="main-nav-link" href="/tags">Tags</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      <nav id="sub-nav">
        <div id="search-form-wrap">
          <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://dujushi.github.io"></form>
        </div>
      </nav>
    </div>
  </div>
</header>
    <section id="main" class="outer">
      <article id="blog-Pagination-With-Partial-View" class="article article-type-blog" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/03/Pagination-With-Partial-View/">Pagination With Partial View</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2015/12/03/Pagination-With-Partial-View/" class="article-date">
  <time datetime="2015-12-03T09:45:26.000Z" itemprop="datePublished">2015-12-03</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/ASP-NET-MVC/">ASP.NET MVC</a>
  </div>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>This pagination feature with partial view was inspired by Adam Freeman’s pagination html helper in his book <code>&lt;Pro ASP.NET MVC 5&gt;</code>. Instead of using html helper, I implemented it with a partial view so I could customize the content and style easily.</p>
<h3 id="Pagination_View_Model">Pagination View Model</h3><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Pagination</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> TotalItems &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> ItemsPerPage &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> CurrentPage &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> Func&lt;<span class="keyword">int</span>, <span class="keyword">string</span>&gt; PageUrl &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> TotalPages =&gt; (<span class="keyword">int</span>)Math.Ceiling((<span class="keyword">decimal</span>)TotalItems / ItemsPerPage);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>We use lamba expression PageUrl to generate page url dynamically.</p>
<h3 id="Partial_View">Partial View</h3><figure class="highlight django"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml">@model Pagination.Models.Pagination</span><br><span class="line"></span><br><span class="line">@&#123;</span><br><span class="line">    bool showPrevious = Model.CurrentPage &gt; 1;</span><br><span class="line">    bool showNext = Model.CurrentPage <span class="tag">&lt; <span class="attribute">Model.TotalPages</span>;</span><br><span class="line">    <span class="attribute">bool</span> <span class="attribute">showAll</span> = <span class="attribute">Model.TotalPages</span> &lt;= <span class="attribute">11</span>;</span><br><span class="line">    <span class="attribute">int</span> <span class="attribute">gapSize</span> = <span class="attribute">5</span>;</span><br><span class="line">    <span class="attribute">bool</span> <span class="attribute">showFirstGap</span> = <span class="attribute">Model.CurrentPage</span> <span class="attribute">-</span> <span class="attribute">1</span> &gt;</span>= gapSize;</span><br><span class="line">    bool showSecondGap = Model.TotalPages - Model.CurrentPage &gt;= gapSize;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@if (Model.TotalPages &gt; 1)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"paginate"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">ul</span>&gt;</span></span><br><span class="line">            @if (showPrevious)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="tag">&lt;<span class="title">li</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"@Model.PageUrl(Model.CurrentPage - 1)"</span>&gt;</span>Previous<span class="tag">&lt;/<span class="title">a</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="title">li</span>&gt;</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            @if (showAll)</span><br><span class="line">            &#123;</span><br><span class="line">                for (int i = 1; i <span class="tag">&lt;<span class="title">=</span> <span class="attribute">Model.TotalPages</span>; <span class="attribute">i</span>++)</span><br><span class="line">                &#123;</span><br><span class="line">                    &lt;<span class="attribute">li</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"@Model.PageUrl(i)"</span> <span class="attribute">class</span>=<span class="value">"@(Model.CurrentPage == i ? "</span><span class="value">active"</span> <span class="attribute">:</span> "")"&gt;</span>@i<span class="tag">&lt;/<span class="title">a</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="title">li</span>&gt;</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            else</span><br><span class="line">            &#123;</span><br><span class="line">                if (showFirstGap &amp;&amp; showSecondGap)</span><br><span class="line">                &#123;</span><br><span class="line">                    for (int i = 1; i <span class="tag">&lt;<span class="title">=</span> <span class="attribute">2</span>; <span class="attribute">i</span>++)</span><br><span class="line">                    &#123;</span><br><span class="line">                        &lt;<span class="attribute">li</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"@Model.PageUrl(i)"</span>&gt;</span>@i<span class="tag">&lt;/<span class="title">a</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="title">li</span>&gt;</span></span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="tag">&lt;<span class="title">li</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"#"</span> <span class="attribute">class</span>=<span class="value">"gap"</span>&gt;</span>&amp;hellip;<span class="tag">&lt;/<span class="title">a</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="title">li</span>&gt;</span></span><br><span class="line">                    for (int i = Model.CurrentPage - 1; i <span class="tag">&lt;<span class="title">=</span> <span class="attribute">Model.CurrentPage</span> + <span class="attribute">1</span>; <span class="attribute">i</span>++)</span><br><span class="line">                    &#123;</span><br><span class="line">                        &lt;<span class="attribute">li</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"@Model.PageUrl(i)"</span> @(<span class="attribute">Model.CurrentPage</span> =<span class="value">=</span> <span class="attribute">i</span> ? "<span class="attribute">class</span>=<span class="value">active"</span> <span class="attribute">:</span> "")&gt;</span>@i<span class="tag">&lt;/<span class="title">a</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="title">li</span>&gt;</span></span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="tag">&lt;<span class="title">li</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"#"</span> <span class="attribute">class</span>=<span class="value">"gap"</span>&gt;</span>&amp;hellip;<span class="tag">&lt;/<span class="title">a</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="title">li</span>&gt;</span></span><br><span class="line">                    for (int i = Model.TotalPages - 1; i <span class="tag">&lt;<span class="title">=</span> <span class="attribute">Model.TotalPages</span>; <span class="attribute">i</span>++)</span><br><span class="line">                    &#123;</span><br><span class="line">                        &lt;<span class="attribute">li</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"@Model.PageUrl(i)"</span>&gt;</span>@i<span class="tag">&lt;/<span class="title">a</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="title">li</span>&gt;</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                else if (!showFirstGap)</span><br><span class="line">                &#123;</span><br><span class="line">                    for (int i = 1; i <span class="tag">&lt;<span class="title">=</span> <span class="attribute">gapSize</span> + <span class="attribute">1</span>; <span class="attribute">i</span>++)</span><br><span class="line">                    &#123;</span><br><span class="line">                        &lt;<span class="attribute">li</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"@Model.PageUrl(i)"</span> @(<span class="attribute">Model.CurrentPage</span> =<span class="value">=</span> <span class="attribute">i</span> ? "<span class="attribute">class</span>=<span class="value">active"</span> <span class="attribute">:</span> "")&gt;</span>@i<span class="tag">&lt;/<span class="title">a</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="title">li</span>&gt;</span></span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="tag">&lt;<span class="title">li</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"#"</span> <span class="attribute">class</span>=<span class="value">"gap"</span>&gt;</span>&amp;hellip;<span class="tag">&lt;/<span class="title">a</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="title">li</span>&gt;</span></span><br><span class="line">                    for (int i = Model.TotalPages - 1; i <span class="tag">&lt;<span class="title">=</span> <span class="attribute">Model.TotalPages</span>; <span class="attribute">i</span>++)</span><br><span class="line">                    &#123;</span><br><span class="line">                        &lt;<span class="attribute">li</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"@Model.PageUrl(i)"</span>&gt;</span>@i<span class="tag">&lt;/<span class="title">a</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="title">li</span>&gt;</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                else</span><br><span class="line">                &#123;</span><br><span class="line">                    for (int i = 1; i <span class="tag">&lt;<span class="title">=</span> <span class="attribute">2</span>; <span class="attribute">i</span>++)</span><br><span class="line">                    &#123;</span><br><span class="line">                        &lt;<span class="attribute">li</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"@Model.PageUrl(i)"</span>&gt;</span>@i<span class="tag">&lt;/<span class="title">a</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="title">li</span>&gt;</span></span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="tag">&lt;<span class="title">li</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"#"</span> <span class="attribute">class</span>=<span class="value">"gap"</span>&gt;</span>&amp;hellip;<span class="tag">&lt;/<span class="title">a</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="title">li</span>&gt;</span></span><br><span class="line">                    for (int i = Model.TotalPages - gapSize; i <span class="tag">&lt;<span class="title">=</span> <span class="attribute">Model.TotalPages</span>; <span class="attribute">i</span>++)</span><br><span class="line">                    &#123;</span><br><span class="line">                        &lt;<span class="attribute">li</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"@Model.PageUrl(i)"</span> @(<span class="attribute">Model.CurrentPage</span> =<span class="value">=</span> <span class="attribute">i</span> ? "<span class="attribute">class</span>=<span class="value">active"</span> <span class="attribute">:</span> "")&gt;</span>@i<span class="tag">&lt;/<span class="title">a</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="title">li</span>&gt;</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            @if (showNext)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="tag">&lt;<span class="title">li</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"@Model.PageUrl(Model.CurrentPage + 1)"</span>&gt;</span>Next<span class="tag">&lt;/<span class="title">a</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="title">li</span>&gt;</span></span><br><span class="line">            &#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="title">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">&#125;</span></span><br></pre></td></tr></table></figure>
<p>If there are more than 11 page links, it will hide some page links to make it tidy.</p>
<h3 id="Style">Style</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="class">.paginate</span> <span class="rules">&#123;</span><br><span class="line">  <span class="rule"><span class="attribute">text-align</span>:<span class="value"> center</span></span>; </span><br><span class="line">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="class">.paginate</span> <span class="tag">ul</span> <span class="rules">&#123;</span><br><span class="line">    <span class="rule"><span class="attribute">list-style</span>:<span class="value"> none</span></span>;</span><br><span class="line">    <span class="rule"><span class="attribute">margin</span>:<span class="value"> <span class="number">0</span></span></span>;</span><br><span class="line">    <span class="rule"><span class="attribute">padding</span>:<span class="value"> <span class="number">0</span></span></span>; </span><br><span class="line">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="class">.paginate</span> <span class="tag">li</span> <span class="rules">&#123;</span><br><span class="line">    <span class="rule"><span class="attribute">display</span>:<span class="value"> inline</span></span>; </span><br><span class="line">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="class">.paginate</span> <span class="tag">a</span> <span class="rules">&#123;</span><br><span class="line">    <span class="rule"><span class="attribute">text-decoration</span>:<span class="value"> none</span></span>;</span><br><span class="line">    <span class="rule"><span class="attribute">margin</span>:<span class="value"> <span class="number">1px</span> <span class="number">2px</span></span></span>;</span><br><span class="line">    <span class="rule"><span class="attribute">padding</span>:<span class="value"> <span class="number">5px</span> <span class="number">10px</span></span></span>;</span><br><span class="line">    <span class="rule"><span class="attribute">border-radius</span>:<span class="value"> <span class="number">3px</span></span></span>;</span><br><span class="line">    <span class="rule"><span class="attribute">box-shadow</span>:<span class="value"> <span class="function">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.2</span>) <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1px</span></span></span>;</span><br><span class="line">    <span class="rule"><span class="attribute">color</span>:<span class="value"> <span class="hexcolor">#717171</span></span></span>;</span><br><span class="line">    <span class="rule"><span class="attribute">background-color</span>:<span class="value"> <span class="hexcolor">#f5f5f5</span></span></span>; </span><br><span class="line">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="class">.paginate</span> <span class="class">.active</span> <span class="rules">&#123;</span><br><span class="line">    <span class="rule"><span class="attribute">color</span>:<span class="value"> <span class="hexcolor">#f2f2f2</span></span></span>;</span><br><span class="line">    <span class="rule"><span class="attribute">background-color</span>:<span class="value"> <span class="hexcolor">#676767</span></span></span>;</span><br><span class="line">    <span class="rule"><span class="attribute">border-color</span>:<span class="value"> <span class="hexcolor">#505050</span></span></span>; </span><br><span class="line">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="class">.paginate</span> <span class="class">.gap</span> <span class="rules">&#123;</span><br><span class="line">    <span class="rule"><span class="attribute">background</span>:<span class="value"> transparent</span></span>;</span><br><span class="line">    <span class="rule"><span class="attribute">box-shadow</span>:<span class="value"> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> transparent</span></span>;</span><br><span class="line">    <span class="rule"><span class="attribute">cursor</span>:<span class="value"> context-menu</span></span>; </span><br><span class="line">&#125;</span></span><br></pre></td></tr></table></figure>
<p>I borrowed some nice style from this repo: <a href="https://github.com/brajeshwar/paginate" target="_blank" rel="external">https://github.com/brajeshwar/paginate</a></p>
<h3 id="Controller">Controller</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> ActionResult <span class="title">List</span><span class="params">(<span class="keyword">int</span> page = <span class="number">1</span>)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    var model = db.Tasks.OrderByDescending(t =&gt; t.Id).AsQueryable();</span><br><span class="line">    <span class="keyword">int</span> totalItems = model.Count();</span><br><span class="line">    <span class="keyword">int</span> itemsPerPage = <span class="number">10</span>;</span><br><span class="line">    model = model</span><br><span class="line">        .Skip(itemsPerPage*(page - <span class="number">1</span>))</span><br><span class="line">        .Take(itemsPerPage);</span><br><span class="line"></span><br><span class="line">    ViewBag.Pagination = <span class="keyword">new</span> Pagination</span><br><span class="line">    &#123;</span><br><span class="line">        TotalItems = totalItems,</span><br><span class="line">        ItemsPerPage = itemsPerPage,</span><br><span class="line">        CurrentPage = page,</span><br><span class="line">        PageUrl = x =&gt; Url.Action(<span class="string">"List"</span>, <span class="keyword">new</span> &#123;page = x&#125;)</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> View(model);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Include_Partial_View">Include Partial View</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@Html.<span class="function"><span class="title">Partial</span><span class="params">(<span class="string">"_Pagination"</span>, (Pagination)</span><span class="title">ViewBag</span></span>.Pagination)</span><br></pre></td></tr></table></figure>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/C-Sharp/">C Sharp</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Pagination/">Pagination</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Partial-View/">Partial View</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="blog-Implement-Show-More-Button-for-A-Task-List" class="article article-type-blog" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/26/Implement-Show-More-Button-for-A-Task-List/">Implement Show More Button for A Task List</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2015/11/26/Implement-Show-More-Button-for-A-Task-List/" class="article-date">
  <time datetime="2015-11-26T07:20:19.000Z" itemprop="datePublished">2015-11-26</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/ASP-NET-MVC/">ASP.NET MVC</a>
  </div>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>To limite page size, we only want to list a limited number of items at first. And then click Show More button to render more items. We can use partial view to reuse our code. In this example we will implement a simple task list. </p>
<ol>
<li><p>Create show task action</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> ActionResult <span class="title">ShowTask</span><span class="params">(<span class="keyword">bool</span> showAll = <span class="literal">false</span>)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> pageSize = <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">bool</span> showMoreButton = <span class="literal">false</span>;</span><br><span class="line">    var model = db.Tasks.AsQueryable();</span><br><span class="line">    <span class="keyword">if</span> (!showAll)</span><br><span class="line">    &#123;</span><br><span class="line">        showMoreButton = model.Count() &gt; pageSize;</span><br><span class="line">        model = model.Take(pageSize);</span><br><span class="line">    &#125;</span><br><span class="line">    ViewBag.ShowMoreButton = showMoreButton;</span><br><span class="line">    <span class="keyword">return</span> PartialView(<span class="string">"_ShowTask"</span>, model);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Create PartialView _ShowTask.cshtml</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">@model IEnumerable&lt;HtmlAction.Models.Task&gt;</span><br><span class="line"></span><br><span class="line">&lt;<span class="keyword">div</span> <span class="property">id</span>=<span class="string">"task_container"</span>&gt;</span><br><span class="line">    @foreach (var <span class="property">item</span> <span class="keyword">in</span> Model)</span><br><span class="line">    &#123;</span><br><span class="line">        &lt;<span class="keyword">div</span> data-<span class="property">id</span>=<span class="string">"@item.Id"</span> <span class="type">class</span>=<span class="string">"task_item"</span>&gt;</span><br><span class="line">            &lt;span&gt;</span><br><span class="line">            @<span class="property">item</span>.Content</span><br><span class="line">        &lt;/span&gt;</span><br><span class="line">            &lt;a href=<span class="string">"#"</span> <span class="type">class</span>=<span class="string">"switch@(item.Status ? "</span> complete<span class="string">" : "</span><span class="string">")"</span> title=<span class="string">"Complete"</span>&gt;&amp;<span class="comment">#10004&lt;/a&gt;</span></span><br><span class="line">        &lt;/<span class="keyword">div</span>&gt;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @<span class="keyword">if</span> (ViewBag.ShowMoreButton)</span><br><span class="line">    &#123;</span><br><span class="line">        &lt;a href=<span class="string">"#"</span> <span class="property">id</span>=<span class="string">"show_more"</span>&gt;Show More&lt;/a&gt;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/<span class="keyword">div</span>&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>In the list page, we can use Html.Action to show some items.</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@Html.<span class="function"><span class="title">Action</span><span class="params">(<span class="string">"ShowTask"</span>)</span></span></span><br></pre></td></tr></table></figure>
</li>
<li><p>And then we implement an AJAX function for ‘Show More’ button.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">"#show_more"</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    $.ajax(&#123;</span><br><span class="line">        type: <span class="string">"GET"</span>,</span><br><span class="line">        url: <span class="string">"/Task/ShowTask"</span>,</span><br><span class="line">        data: &#123; <span class="string">"showAll"</span>: <span class="literal">true</span>&#125;,</span><br><span class="line">        success: <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">            $(<span class="string">"#task_container"</span>).html(data);</span><br><span class="line">        &#125;,</span><br><span class="line">        error: <span class="function"><span class="keyword">function</span> (<span class="params">request, status, err</span>) </span>&#123;</span><br><span class="line">            alert(<span class="string">"System error, try again later."</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>We may want to implement an AJAX function to switch the status.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="built_in">document</span>).on(<span class="string">"click"</span>, <span class="string">".switch"</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> id = $(<span class="keyword">this</span>).closest(<span class="string">".task_item"</span>).data(<span class="string">"id"</span>);</span><br><span class="line">    <span class="keyword">var</span> className = <span class="string">"complete"</span>;</span><br><span class="line">    <span class="keyword">var</span> status = $(<span class="keyword">this</span>).hasClass(className);</span><br><span class="line">    $.ajax(&#123;</span><br><span class="line">        context: <span class="keyword">this</span>,</span><br><span class="line">        type: <span class="string">"POST"</span>,</span><br><span class="line">        url: <span class="string">"/Task/StatusSwitch"</span>,</span><br><span class="line">        data: &#123; <span class="string">"id"</span>: id, <span class="string">"status"</span>: status &#125;,</span><br><span class="line">        dataType: <span class="string">"json"</span>,</span><br><span class="line">        success: <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (data.Success == <span class="literal">true</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (status) &#123;</span><br><span class="line">                    $(<span class="keyword">this</span>).removeClass(className);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    $(<span class="keyword">this</span>).addClass(className);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                alert(<span class="string">"System error, try again later."</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        error: <span class="function"><span class="keyword">function</span> (<span class="params">request, status, err</span>) </span>&#123;</span><br><span class="line">            alert(<span class="string">"System error, try again later."</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>There are some tricks in this function:</p>
<ol>
<li>we use <code>$(document).on(&quot;click&quot;, &quot;.switch&quot;, function () {})</code> instead of <code>$(&quot;.switch&quot;).click(function() {})</code>, so that all AJAX renderred switches can invoke the AJAX function as well.</li>
<li>We add <code>context: this</code> to change context to the switch button we click on. So we can change the style of the switch button inside the function.</li>
</ol>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/AJAX/">AJAX</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/C-Sharp/">C Sharp</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/jQuery/">jQuery</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="blog-Generate-A-Dropdown-List-for-Enum" class="article article-type-blog" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/26/Generate-A-Dropdown-List-for-Enum/">Generate A Dropdown List for Enum</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2015/11/26/Generate-A-Dropdown-List-for-Enum/" class="article-date">
  <time datetime="2015-11-26T06:56:52.000Z" itemprop="datePublished">2015-11-26</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/ASP-NET-MVC/">ASP.NET MVC</a>
  </div>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>We often use an Enum in C# to define all options for a field, such as a category Enum:<br><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public <span class="class"><span class="keyword">enum</span> <span class="title">CategoryEnum</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="constant">Book</span>,</span><br><span class="line">    <span class="constant">Food</span>,</span><br><span class="line">    <span class="constant">Tourism</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>And we need a dropdown list for this category field. How would you implement this?</p>
<h3 id="Basic">Basic</h3><p>First, we get all values of CategoryEnum:<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Enum.<span class="function"><span class="title">GetValues</span><span class="params">(typeof(CategoryEnum)</span></span>)</span><br></pre></td></tr></table></figure></p>
<p>Then, we generate all select items for these values:<br><figure class="highlight sml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Enum</span>.<span class="type">GetValues</span>(typeof(<span class="type">CategoryEnum</span>)).<span class="type">Cast</span>&lt;<span class="type">CategoryEnum</span>&gt;<span class="literal">()</span>.<span class="type">Select</span>(t =&gt; new <span class="type">SelectListItem</span> &#123; <span class="type">Text</span> = t.<span class="type">ToString</span><span class="literal">()</span>, <span class="type">Value</span> = ((<span class="built_in">int</span>)t).<span class="type">ToString</span><span class="literal">()</span> &#125;)</span><br></pre></td></tr></table></figure></p>
<p>Here we use <code>Cast&lt;CategoryEnum&gt;()</code> to cast all the values so we can apply Select method on them.<br>Finally, we have our dropdown list:<br><figure class="highlight sml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@<span class="type">Html</span>.<span class="type">DropDownListFor</span>(m =&gt; m.<span class="type">Category</span>, <span class="type">Enum</span>.<span class="type">GetValues</span>(typeof(<span class="type">CategoryEnum</span>)).<span class="type">Cast</span>&lt;<span class="type">CategoryEnum</span>&gt;<span class="literal">()</span>.<span class="type">Select</span>(t =&gt; new <span class="type">SelectListItem</span> &#123; <span class="type">Text</span> = t.<span class="type">ToString</span><span class="literal">()</span>, <span class="type">Value</span> = ((<span class="built_in">int</span>)t).<span class="type">ToString</span><span class="literal">()</span> &#125;), <span class="string">"Select one"</span>)</span><br></pre></td></tr></table></figure></p>
<h3 id="Custom_Text">Custom Text</h3><p>We can add descriptions to CategoryEnum and use them as the text value of each select list item.<br><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">public <span class="class"><span class="keyword">enum</span> <span class="title">CategoryEnum</span></span></span><br><span class="line">&#123;</span><br><span class="line">    [<span class="constant">Description</span>(<span class="string">"Fancy Book"</span>)]</span><br><span class="line">    <span class="constant">Book</span>,</span><br><span class="line">    [<span class="constant">Description</span>(<span class="string">"Delicious Food"</span>)]</span><br><span class="line">    <span class="constant">Food</span>,</span><br><span class="line">    [<span class="constant">Description</span>(<span class="string">"The World Is Big"</span>)]</span><br><span class="line">    <span class="constant">Tourism</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>We then get the description with Attribute.GetCustomAttribute method.<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">((DescriptionAttribute)Attribute.<span class="function"><span class="title">GetCustomAttribute</span><span class="params">((t.GetType()</span></span>).<span class="function"><span class="title">GetField</span><span class="params">(t.ToString()</span></span>), <span class="function"><span class="title">typeof</span><span class="params">(DescriptionAttribute)</span></span>)).Description</span><br></pre></td></tr></table></figure></p>
<p>The updated code for the dropdown list would be:<br><figure class="highlight sml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@<span class="type">Html</span>.<span class="type">DropDownListFor</span>(m =&gt; m.<span class="type">Category</span>, <span class="type">Enum</span>.<span class="type">GetValues</span>(typeof(<span class="type">CategoryEnum</span>)).<span class="type">Cast</span>&lt;<span class="type">CategoryEnum</span>&gt;<span class="literal">()</span>.<span class="type">Select</span>(t =&gt; new <span class="type">SelectListItem</span> &#123; <span class="type">Text</span> = ((<span class="type">DescriptionAttribute</span>)<span class="type">Attribute</span>.<span class="type">GetCustomAttribute</span>((t.<span class="type">GetType</span><span class="literal">()</span>).<span class="type">GetField</span>(t.<span class="type">ToString</span><span class="literal">()</span>), typeof(<span class="type">DescriptionAttribute</span>))).<span class="type">Description</span>, <span class="type">Value</span> = ((<span class="built_in">int</span>)t).<span class="type">ToString</span><span class="literal">()</span> &#125;), <span class="string">"Select one"</span>)</span><br></pre></td></tr></table></figure></p>
<h3 id="Option_Group">Option Group</h3><p>Sometimes we only want to display a subset of the Enum. We can define a static class for this so it can be shared everywhere.<br><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">CategoryEnumGroups</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> CategoryEnum[] OutdoorGroup = &#123; CategoryEnum.Food, CategoryEnum.Tourism &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Then we can filter them with Where method.<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Enum.<span class="function"><span class="title">GetValues</span><span class="params">(typeof(CategoryEnum)</span></span>).Cast&lt;CategoryEnum&gt;().<span class="function"><span class="title">Where</span><span class="params">(t =&gt; CategoryEnumGroups.OutdoorGroup.Contains(t)</span></span>)</span><br></pre></td></tr></table></figure></p>
<p>Final dropdown list code:<br><figure class="highlight sml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@<span class="type">Html</span>.<span class="type">DropDownListFor</span>(m =&gt; m.<span class="type">Category</span>, <span class="type">Enum</span>.<span class="type">GetValues</span>(typeof(<span class="type">CategoryEnum</span>)).<span class="type">Cast</span>&lt;<span class="type">CategoryEnum</span>&gt;<span class="literal">()</span>.<span class="type">Where</span>(t =&gt; <span class="type">CategoryEnumGroups</span>.<span class="type">OutdoorGroup</span>.<span class="type">Contains</span>(t)).<span class="type">Select</span>(t =&gt; new <span class="type">SelectListItem</span> &#123; <span class="type">Text</span> = ((<span class="type">DescriptionAttribute</span>)<span class="type">Attribute</span>.<span class="type">GetCustomAttribute</span>((t.<span class="type">GetType</span><span class="literal">()</span>).<span class="type">GetField</span>(t.<span class="type">ToString</span><span class="literal">()</span>), typeof(<span class="type">DescriptionAttribute</span>))).<span class="type">Description</span>, <span class="type">Value</span> = ((<span class="built_in">int</span>)t).<span class="type">ToString</span><span class="literal">()</span> &#125;), <span class="string">"Select one"</span>)</span><br></pre></td></tr></table></figure></p>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/C-Sharp/">C Sharp</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Dropdown-List/">Dropdown List</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Enum/">Enum</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="blog-Custom-Validator-For-ASP-NET-MVC-MustBeTrue" class="article article-type-blog" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/18/Custom-Validator-For-ASP-NET-MVC-MustBeTrue/">Custom Validator For ASP.NET MVC: MustBeTrue</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2015/11/18/Custom-Validator-For-ASP-NET-MVC-MustBeTrue/" class="article-date">
  <time datetime="2015-11-18T07:22:05.000Z" itemprop="datePublished">2015-11-18</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/ASP-NET-MVC/">ASP.NET MVC</a>
  </div>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>Recently I was working on a small project to add a checkbox for users to accept Terms and Conditions during registration. In order to use the built-in validation functions by ASP.NET MVC, I wrote a small custom validator for this: MustBeTrue.</p>
<ol>
<li><p>Create MustBeTrueAttribute.cs file under Attributes folder</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[AttributeUsage(AttributeTargets.Property, AllowMultiple = <span class="literal">false</span>, Inherited = <span class="literal">true</span>)]</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MustBeTrueAttribute</span> : <span class="typename">ValidationAttribute</span>, <span class="typename">IClientValidatable</span></span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">// for server side validation</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">override</span> bool IsValid(<span class="keyword">object</span> value)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> value <span class="keyword">is</span> bool &amp;&amp; (bool)value;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// add data- to elements for client side validation</span></span><br><span class="line">	<span class="keyword">public</span> IEnumerable<span class="type">&lt;ModelClientValidationRule&gt;</span> GetClientValidationRules(ModelMetadata metadata, ControllerContext context)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="variable"><span class="keyword">var</span> clientValidationRule</span> = new ModelClientValidationRule()</span><br><span class="line">		&#123;</span><br><span class="line">			ErrorMessage = FormatErrorMessage(metadata.GetDisplayName()),</span><br><span class="line">			ValidationType = <span class="string">"mustbetrue"</span></span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="keyword">return</span> new[] &#123; clientValidationRule &#125;;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Create an adapter for Unobtrusive: jquery.validate.unobtrusive.mustbetrue.js</p>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="list">(<span class="keyword">function</span> <span class="list">($)</span> <span class="collection">&#123;</span><br><span class="line">    $.validator.addMethod<span class="list">(<span class="string">"mustbetrue"</span>, function <span class="list">(<span class="keyword">value</span>, element, params)</span> <span class="collection">&#123;</span><br><span class="line">		//check whether the element is checked</span><br><span class="line">        return $<span class="list">(<span class="keyword">element</span>)</span>.is<span class="list">(<span class="string">":checked"</span>)</span><span class="comment">;</span></span><br><span class="line">    &#125;</span>)</span><span class="comment">;</span></span><br><span class="line">    $.validator.unobtrusive.adapters.addBool<span class="list">(<span class="string">"mustbetrue"</span>)</span><span class="comment">;</span></span><br><span class="line">&#125;</span><span class="list">(<span class="keyword">jQuery</span>)</span>)</span><span class="comment">;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Usage in View Model</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="list">[<span class="keyword">MustBeTrue</span><span class="list">(<span class="keyword">ErrorMessage</span> = <span class="string">"Please accept the Terms &amp; Conditions."</span>)</span>]</span><br><span class="line"><span class="list">[<span class="keyword">DisplayName</span><span class="list">(<span class="string">"I accept the Terms &amp; Conditions."</span>)</span>]</span><br><span class="line">public bool AcceptTerms &#123; get<span class="comment">; set; &#125;</span></span></span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="Github">Github</h3><p><a href="https://github.com/dujushi/snippets/tree/master/MustBeTrue" target="_blank" rel="external">https://github.com/dujushi/snippets/tree/master/MustBeTrue</a></p>
<h3 id="Reference:">Reference:</h3><ol>
<li><a href="http://jasonwatmore.com/post/2013/10/16/ASPNET-MVC-Required-Checkbox-with-Data-Annotations.aspx" target="_blank" rel="external">ASP.NET MVC - Required Checkbox with Data Annotations</a></li>
<li><a href="http://www.devtrends.co.uk/blog/the-complete-guide-to-validation-in-asp.net-mvc-3-part-1" target="_blank" rel="external">THE COMPLETE GUIDE TO VALIDATION IN ASP.NET MVC 3</a></li>
<li><a href="http://bradwilson.typepad.com/blog/2010/10/mvc3-unobtrusive-validation.html" target="_blank" rel="external">Unobtrusive Client Validation in ASP.NET MVC 3</a></li>
</ol>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Validation/">Validation</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="blog-ASP-NET-Web-Development-With-Visual-Studio-2015-and-Local-IIS-7-on-Windows-7" class="article article-type-blog" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/12/ASP-NET-Web-Development-With-Visual-Studio-2015-and-Local-IIS-7-on-Windows-7/">ASP.NET Web Development With Visual Studio 2015 and Local IIS 7 on Windows 7</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2015/11/12/ASP-NET-Web-Development-With-Visual-Studio-2015-and-Local-IIS-7-on-Windows-7/" class="article-date">
  <time datetime="2015-11-12T08:41:30.000Z" itemprop="datePublished">2015-11-12</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/ASP-NET-MVC/">ASP.NET MVC</a>
  </div>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>Visual Studio 2015 provides ASP.NET web development environment directly with IIS Express. It is very straight forward to start web development with this setting. But if you ever used Visual Studio 2015 with Local IIS, you would find that it is much more convenient and you would love it.</p>
<p>This tutorial will go through how to set up ASP.NET web development environment with Visual Studio 2015 and Local IIS on Windows 7 briefly.
        
          <p class="article-more-link">
            <a href="/2015/11/12/ASP-NET-Web-Development-With-Visual-Studio-2015-and-Local-IIS-7-on-Windows-7/#more">Read More</a>
          </p>
        
      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Local-IIS/">Local IIS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Visual-Studio-2015/">Visual Studio 2015</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Windows-7/">Windows 7</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="post-Magento-1-Development-Environment-Setup" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/08/Magento-1-Development-Environment-Setup/">Magento 1 Development Environment Setup</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2015/10/08/Magento-1-Development-Environment-Setup/" class="article-date">
  <time datetime="2015-10-08T08:12:25.000Z" itemprop="datePublished">2015-10-08</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/Magento-1/">Magento 1</a>
  </div>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>There is an advanced Magento development environment setup tool implemented by <a href="https://github.com/davidalger/devenv" target="_blank" rel="external">davidalger</a>. But I’d like to keep my env simple and basic:P So I decided to make my own. </p>
<p>The Env is a simple LAMP server with some basic automations based on Vagrant and Virtualbox. I chose to set it up with the most popular Vagrant box <a href="https://atlas.hashicorp.com/ubuntu/boxes/trusty64" target="_blank" rel="external">ubuntu/trusty64</a>. Then, I wrote a simple shell script lamp.sh as a provisoning file to install LAMP and set up the demo site mage.local. If you need another brand new demo site, simply call: <code>sh alpha.sh</code>. This will set up another site: alpha.local. Otherwise, you can recreate the mage.local demo site by calling <code>sh mage.local</code>. </p>
<p>This setup is basic. Everything is static, but it suffices to boost my local development anyway:P</p>
<p>Check it out if you want: <a href="https://github.com/dujushi/magento-I-development-env" target="_blank" rel="external">https://github.com/dujushi/magento-I-development-env</a>.</p>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Development-Environment/">Development Environment</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Magento-1/">Magento 1</a></li></ul>

      </footer>
    
  </div>
  
</article>


    </section>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2015 Peikai Guo&nbsp;
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, theme by <a href="http://github.com/ppoffice">PPOffice</a>
    </div>
  </div>
</footer>
    

<script src="/js/jquery.min.js"></script>



<script src="/js/script.js" type="text/javascript"></script>
  </div>
</body>
</html>